<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org/">
<head th:replace="~{/common/config.html :: config}">
</head>
<body>
	<header th:replace="~{/common/header.html :: header}"></header>

	<main class="main" style="width: 100%; overflow-x: auto;">
		<section th:replace="~{/common/breadcrumb.html :: breadcrumb}"></section>
		<section class="container ">
			<!-- Title -->
			<div
				class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-4">
				<h2 class="mb-1">입고 창고 리스트</h2>
			</div>
	<!-- 토글 버튼 영역 -->
	<div class="mb-4" id="list-type" style="border-radius: 15px; border: 1px solid #82CCDD; display: flex; justify-content: space-evenly; width: 450px;">
		<button type="button" class="toggle_btns" onclick="toggleWh('all')"   style="background: transparent; color: #000;">전체</button>
		<button type="button" class="toggle_btns" onclick="toggleWh('in')" id="wh_type" value="in"  style="background: #82CCDD; color: #fff;">입고</button>
		<button type="button" class="toggle_btns" onclick="toggleWh('out')"  style="background: transparent; color: #000;">출고</button>
		<button type="button" class="toggle_btns" onclick="toggleWh('fs')"  style="background: transparent; color: #000;">완제품</button>
		<button type="button" class="toggle_btns" onclick="toggleWh('mt')"  style="background: transparent; color: #000;">부자재</button>
	</div>

			<label class="form-label d-block  mb-2">*선택하신 부자재 창고로 선택된 입고 품목들이 이동 됩니다.</label>
			<!-- 같은 줄 안에 배치 (d-flex로 정렬), 기능은 각각 따로 -->
			<div class="d-flex justify-content-between align-items-center gap-3 mb-3">
			
			<!-- 버튼 + 이동 입력폼 (최대한 테이블에 붙임) -->
			<div class="d-flex align-items-center gap-2 mb-2">
			  <button class="btn btn-primary modal-trigger"
			        type="button"
			        th:data-modal-url="@{/wh_type_list.do(wh_type='mt_wh')}"
			        data-modal-id="wh_type_list"
			        style="cursor: pointer;">
			    <i class="bi bi-search"></i>
			</button>
			
			  <form class="d-flex align-items-center gap-2 mb-0" >
			    <input type="text" id="wh_code" class="form-control" style="width: 200px;" placeholder="부자재 창고가 선택됩니다."/>
			    <input type="hidden" name="inbound_code" id="inbound_code" class="form-control" />
			    <input type="hidden" name="item_code" id="item_code" class="form-control" />
			    <input type="hidden" id="client_code" class="form-control" />
			    <input type="hidden" id="wh_type" class="form-control" />
			    <button type="button" class="btn btn-info d-flex align-items-center px-2"
			            style="white-space: nowrap; min-width: 70px;" onclick="whMoveBtn()">
			      <i class="bi bi-rocket-takeoff me-1"></i> 이동
			    </button>
			  </form>
			</div>
			
			<!-- 검색바: 위 margin 줄이기 (my-4 → my-2) -->
			<form class="row g-2 my-2 justify-content-end"
			      th:action="@{/warehouses_in_list.do}" method="get">
			  <div class="col-auto">
			    <div class="input-group input-group-sm">
			      <select class="form-select" name="wh_searchType" style="max-width: 120px;">
			        <option value="" th:selected="${#strings.isEmpty(wh_searchType)}">전체</option>
			      </select> 
			      <input type="text" name="wh_search" class="form-control" placeholder="검색" th:value="${wh_search}">
			      <button class="btn btn-primary" type="submit">
			        <i class="bi bi-search"></i> 검색
			      </button>
			    </div>
			  </div>
			</form>
			</div>
			<!-- 입고창고 List Table ( 입고 창고)-->
			<div class="table-responsive rounded mt-2" th:if="${wh_check == 'yesdata'}">
				<table class="table table-hover align-middle table-bordered" style="white-space: nowrap;">
				  <thead class="table-light text-center">
				    <tr>
				   	  <th scope="col">#</th>
				      <th>번호</th>
				      <th>입고코드</th>
				      <th>창고코드</th>
				      <th>창고이름</th>
				      <th>품목코드</th>
				      <th>품목명</th>
				      <th>분류</th>
				      <th>거래처</th>
				      <th>입고일자</th>
				      <th>입고상태</th>
				      <th>사용여부</th>
				    </tr>
				  </thead>
				  <tbody>
				    <tr class="modal-trigger"
				        th:each="in_wh, iterStat : ${in_wh_list}"
				        th:data-modal-url="@{'/in_warehouse_modal.do?inbound_code=' + ${in_wh.inbound_code}}"
				       	data-modal-id="wh_in_list"
				        style="cursor:pointer;">
				      <td>
				      	<input type="checkbox" name="deleteCodes"
				   			   	class="move-checkbox"
				      	 	   th:value="${in_wh.wh_code}" 
						       th:data-inbound_code="${in_wh.inbound_code}" 
						       th:data-item_code="${in_wh.item_code}" 
						       th:data-client_code="${in_wh.client_code}" 
						       th:data-wh_code="${in_wh.wh_code}" 
						       data-wh_type="mt"
						       onclick="selectRow(this); event.stopPropagation();" />
				      </td>
				      <td th:text="${totalCount - ((currentPage - 1) * pageSize + iterStat.index)}">16</td>
				      <td th:text="${in_wh.inbound_code}">IN-0001</td>
				      <td th:text="${in_wh.wh_code}">WH-001</td>
				      <td th:text="${in_wh.wh_name}">창고이름</td>
				      <td th:text="${in_wh.item_code}">ITEM-123</td>
				      <td th:hidden="${in_wh.client_code}">client-123</td>
				      <td th:text="${in_wh.item_name}">나사</td>
				      <td th:text="${in_wh.category_main + '/' + in_wh.category_sub}">부품/소모품</td>
				      <td th:text="${in_wh.client_name}">삼성전자</td>
				      <td th:text="${in_wh.inbound_date}">2025-05-29</td>
				      <td th:text="${in_wh.in_status}"></td>
				      <td th:text="${in_wh.use_yn}">Y</td>
				    </tr>
				  </tbody>
				</table>
			</div>
			
			<!-- 게시물이 없을 때 -->
      	  <div th:if="${wh_check == 'nodata'}" class="text-center my-4">
         	   등록된 게시물이 없습니다.
      	  </div>
			
			<div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-4">
				 <!-- 페이징 -->
			        <nav aria-label="Page navigation">
			            <ul class="pagination">
			                <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
			                    <a class="page-link" th:href="@{/warehouses_in_list.do(page=${currentPage - 1 > 0 ? currentPage - 1 : 1}, wh_search=${wh_search})}">이전</a>
			                </li>
			
			                <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPages)}" th:classappend="${i == currentPage} ? 'active'">
			                    <a class="page-link" th:href="@{/warehouses_in_list.do(page=${i}, wh_search=${wh_search})}" th:text="${i}">1</a>
			                </li>
			
			                <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
			                    <a class="page-link" th:href="@{/warehouses_in_list.do(page=${currentPage + 1 <= totalPages ? currentPage + 1 : totalPages}, wh_search=${wh_search})}">다음</a>
			                </li>
			                
			                
			            </ul>
			        </nav>
				<!-- Action Buttons -->
				<div class="mt-4 d-flex gap-2">
					<div class="ms-auto">
						 <button type="button" class="btn btn-success" onclick="location.href='/warehouse_in_savePage.do'">
               				 <i class="bi bi-plus-lg"></i> 수기 등록
						</button>
						<button class="btn btn-danger"  onclick="deleteWh('in')">
            				<i class="bi bi-trash"></i> 삭제
          			   </button>
					</div>
				</div>
			</div>

		</section>
	</main>


	<div id="modalContainer"></div>

	<footer th:replace="~{/common/footer.html :: footer}"></footer>

</body>
</html>