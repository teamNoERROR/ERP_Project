<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org/">
<head th:include="~{/common/config.html :: config}">
<script th:src="@{/js/warehouse.js}" defer></script>
</head>
<body>
	<header th:replace="~{/common/header.html :: header}"></header>

	<main class="main">
    <section th:replace="~{/common/breadcrumb.html :: breadcrumb}"></section>

    <section class="container">
        <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-4">
            <h2 class="mb-1">창고 관리</h2>
        </div>

        <!-- 검색 폼 -->
        <form class="row g-2 my-4 justify-content-end" th:action="@{/warehouses_list.do}" method="get">
            <div class="col-auto">
                <div class="input-group input-group-sm">
                    <select class="form-select" name="wh_searchType" style="max-width: 120px;">
                        <option value="" th:selected="${#strings.isEmpty(wh_searchType)}">전체</option>
                        <option value="wh_code" th:selected="${wh_searchType == 'wh_code'}">창고코드</option>
                        <option value="wh_name" th:selected="${wh_searchType == 'wh_name'}">창고명</option>
                    </select>
                    <input type="text" name="wh_search" class="form-control" placeholder="검색" th:value="${wh_search}">
                    <button class="btn btn-primary" type="submit">
                        <i class="bi bi-search"></i> 검색
                    </button>
                </div>
            </div>
        </form>

        <!-- 게시물 테이블 -->
        <div class="table-responsive rounded" th:if="${wh_check == 'yesdata'}">
            <table class="table table-hover align-middle table-bordered">
                <thead class="table-light text-center">
                <tr>
                    <th><input type="checkbox" /></th>
                    <th>번호</th>
                    <th>창고코드</th>
                    <th>창고명</th>
                    <th>창고구분</th>
                    <th>위치</th>
                    <th>대표관리자</th>
                    <th>연락처</th>
                    <th>사용여부</th>
                    <th>비고</th>
                    <th>등록일</th>
                </tr>
                </thead>
                <tbody>
                
                <!--  
                <tr class="modal-trigger" th:each="wh, iterStat : ${wh_list}" th:data-modal-url="@{'/warehouse_modal.do?wh_code=' + ${wh.widx}}" 
                -->
                
               <tr class="modal-trigger" 
   					 th:each="wh, iterStat : ${wh_list}" 
    				 th:data-modal-url="@{'/warehouse_modal.do?wh_code=' + ${#strings.trim(wh.wh_code)}}" 
    				 style="cursor:pointer;">
                    <td><input type="checkbox" th:value="${wh.widx}" /></td>
                    <td th:text="${(currentPage - 1) * pageSize + iterStat.index + 1}">1</td>
                    <td th:text="${wh.wh_code}">WH-001</td>
                    <td th:text="${wh.wh_name}">입고1창고</td>
                    <td th:text="${wh.wh_type}">입고창고</td>
                    <td th:text="${wh.wh_addr1 + ' ' + wh.wh_addr2}">서울시 마포구 ...</td>
                    <td th:text="${wh.ENAME}">서태웅</td>
                    <td th:text="${wh.EPHONE}">031-123-4567</td>
                    <td th:text="${wh.wh_use_flag}">Y</td>
                    <td th:text="${wh.wh_note}">-</td>
                    <td th:text="${wh.wh_insert_date}">2010-05-18</td>
                </tr>
                
                
                </tbody>
            </table>
        </div>

        <!-- 게시물이 없을 때 -->
        <div th:if="${wh_check == 'nodata'}" class="text-center my-4">
            등록된 게시물이 없습니다.
        </div>

        <!-- 페이징 -->
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
                    <a class="page-link" th:href="@{/warehouses_list.do(page=${currentPage - 1 > 0 ? currentPage - 1 : 1}, wh_search=${wh_search})}">이전</a>
                </li>

                <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPages)}" th:classappend="${i == currentPage} ? 'active'">
                    <a class="page-link" th:href="@{/warehouses_list.do(page=${i}, wh_search=${wh_search})}" th:text="${i}">1</a>
                </li>

                <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
                    <a class="page-link" th:href="@{/warehouses_list.do(page=${currentPage + 1 <= totalPages ? currentPage + 1 : totalPages}, wh_search=${wh_search})}">다음</a>
                </li>
            </ul>
        </nav>
        <!-- 추가/삭제 버튼 -->
        <div class="d-flex gap-2 justify-content-end mt-4">
            <button type="button" class="btn btn-success" onclick="location.href='/warehouse_insert.do'">
                <i class="bi bi-plus-lg"></i> 추가
            </button>
            <!-- 
            <button type="button" class="btn btn-danger" onclick="deleteSelected()">
                <i class="bi bi-trash"></i> 삭제
            </button>
             -->
        </div>


    </section>
</main>


	<div id="modalContainer"></div>

	<footer th:replace="~{/common/footer.html :: footer}"></footer>

</body>
</html>